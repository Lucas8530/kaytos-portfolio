import{__assign as e,__spreadArray as t}from"tslib";import n from"path";import r from"remark-mdx";import s from"remark-parse";import o from"unified";var i=["@typescript-eslint/parser","@babel/eslint-parser","babel-eslint","espree"],a=["JSXElement","JSXFragment"],l=function(e){return a.includes(e.type)},u=function(e){if(e){if("string"==typeof e&&(e=require(e)),"object"==typeof e&&(e="parseForESLint"in e&&e.parseForESLint||"parse"in e&&e.parse),"function"!=typeof e)throw new TypeError("Invalid custom parser for `eslint-mdx`: "+e);return[e]}for(var t=[],n=0,r=i;n<r.length;n++){var s=r[n];try{var o=require(s),a="parseForESLint"in o?o.parseForESLint:o.parse;a&&t.push(a)}catch(e){}}return t},c=function(e){var t=e.start.offset,n=e.end.offset;return{range:[t,n],loc:e,start:t,end:n}},p=function(e,t){return"object"==typeof e&&e&&t.every((function(t){return t in e}))},f=function(e,t){for(var n=0,r=e.split("\n"),s=0;s<r.length;s++){var o=s+1,i=n+r[s].length;if(i>=t)return{line:o,column:t-n};n=i+1}},m=function(e,t){if(e&&"object"==typeof e)for(var n=0,r=Object.values(e);n<r.length;n++){var s=r[n];m(s,t)}if(!p(e,["loc","range"]))return e;var o=e.loc,i=o.start,a=o.end,l=e.range,u=l[0],c=l[1],f=[u+=t.offset,c+=t.offset];return Object.assign(e,{start:u,end:c,range:f,loc:{start:{line:t.line+i.line,column:i.column+(1===i.line?t.column:0)},end:{line:t.line+a.line,column:a.column+(1===a.line?t.column:0)}}})},h=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return e.push.apply(e,Array.isArray(t)?t:null==t?[]:[t]),e}),[])},d=function(e){return e&&e[0]},v=function(e){return e&&e[e.length-1]},x="(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*"+("(?:[^\"'=<>`\\u0000-\\u0020]+|'[^']*'|\"[^\"]*\"|"+"{.*}".replace(".","[\0-ï¿¿]")+")")+")?)",g="<[A-Za-z]*[A-Za-z0-9\\.\\-]*"+x+"*\\s*>",y="<\\s*\\/[A-Za-z]*[A-Za-z0-9\\.\\-]*\\s*>",_="<[A-Za-z]*[A-Za-z0-9\\.\\-]*"+x+"*\\s*\\/?>",b="\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e",E="(\x3c!---*)",S="(-*--\x3e)",w="(\x3c!---*)([\\s\\S]*?)(-*--\x3e)",J=new RegExp("^(?:"+g+")$"),N=new RegExp("^(?:"+y+")$"),j=new RegExp("^(?:"+g+"[^<]*"+y+")$"),L=new RegExp("^(?:"+_+")$"),z=new RegExp("^(?:"+b+")$"),T=new RegExp("(\x3c!---*)([\\s\\S]*?)(-*--\x3e)"),A=new RegExp("(\x3c!---*)([\\s\\S]*?)(-*--\x3e)","g"),F=function(e){return J.test(e.trim())},k=function(e){return N.test(e.trim())},P=function(e){return z.test(e.trim())},Z=function(e){return j.test(e.trim())},$=function(e){return L.test(e.trim())},R=function(){function n(e){var t=e.code,n=e.enter;this.code=t,this._enter=n}return n.prototype.combineLeftJsxNodes=function(t,n){var r,s=t[0].position.start,o=e({},v(t).position.end);return n&&(null===(r=n.position.indent)||void 0===r?void 0:r.length)>0&&(o.offset+=n.position.indent.reduce((function(e,t,n){return e+(n?t+1:0)}),0)),{type:"jsx",data:t[0].data,value:this.code.slice(s.offset,o.offset),position:{start:s,end:o}}},n.prototype.combineJsxNodes=function(e,n){var r=this,s=0,o=!1,i=[],a=e.length;return e.reduce((function(e,l,u){if("jsx"===l.type){var c=l.value;if(F(c))s++,o=!0,i.push(l);else{if(k(c))s--,i.push(l);else if(P(c)||$(c)||Z(c))i.push(l);else{u||(s++,o=!0);try{i.push.apply(i,h(V.normalizeJsxNode(l,n)))}catch(e){if(!s){var p=l.position.start;throw Object.assign(new SyntaxError("unknown jsx node: "+JSON.stringify(c)),{lineNumber:p.line,column:p.column,index:p.offset})}i.push(l)}}if(!s){var f=i.findIndex((function(e){return"string"==typeof e.value&&F(e.value)}));-1===f?o?e.push(r.combineLeftJsxNodes(i,n)):e.push.apply(e,i):e.push.apply(e,t(t([],i.slice(0,f)),[r.combineLeftJsxNodes(i.slice(f),n)])),i.length=0}}}else s?i.push(l):e.push(l);return u===a-1&&i.length>0&&e.push(r.combineLeftJsxNodes(i,n)),e}),[])},n.prototype.traverse=function(e,t){if(e){var n=e.children;if(n)for(var r=e,s=0,o=n=e.children=this.combineJsxNodes(n,r);s<o.length;s++){var i=o[s];this.traverse(i,r)}this._enter(e,t)}},n}(),O=function(e,t){return new R(t).traverse(e)},X=o().use(s).freeze(),C=X().use(r).freeze(),H=["body","comments","tokens"],M=["export","import","jsx"],W=["column","lineNumber"],q=[".mdx"],I=[".md"],B={comment:!0,ecmaFeatures:{jsx:!0},ecmaVersion:(new Date).getUTCFullYear(),sourceType:"module",tokens:!0,filePath:"__placeholder__.mdx",loc:!0,range:!0},D="<$>".length,U=function(){function t(){this._options=B,this.parse=this.parse.bind(this),this.parseForESLint=this.parseForESLint.bind(this)}return t.prototype.normalizeJsxNode=function(t,n,r){void 0===r&&(r=this._options);var s=t.value;if("jsx"!==t.type||P(s))return t;if(T.exec(s)){var o=[],i=t.position.start,a=i.line,l=i.column,u=i.offset,c=t.data;Object.assign(t,{data:e(e({},c),{jsxType:"JSXElementWithHTMLComments",comments:o,inline:!!n&&"root"!==n.type}),value:s.replace(A,(function(e,t,n,r,i){var c=i+e.length,p=s.slice(0,i).split("\n"),f=s.slice(0,c).split("\n"),m="{/"+"*".repeat(t.length-2)+n+"*".repeat(r.length-2)+"/}",h=p.length-1,d=f.length-1;return o.push({fixed:m,loc:{start:{line:a+h,column:v(p).length+(h?0:l-1),offset:u+i},end:{line:a+d,column:v(f).length+(d?0:l-1),offset:u+c}},origin:e}),m}))})}return this._normalizeJsxNodes(t,r)},t.prototype.parse=function(e,t){return this.parseForESLint(e,t).ast},t.prototype.parseForESLint=function(t,r){var s=this,o=n.extname(r.filePath),i=q.concat(r.extensions||[]).includes(o),a=I.concat(r.markdownExtensions||[]).includes(o);if(!i&&!a)return this._eslintParse(t,r);var l=(i?C:X).parse(t);return this._ast=e(e({},c(l.position)),{type:"Program",sourceType:r.sourceType||"module",body:[],comments:[],tokens:[]}),this._services={JSXElementsWithHTMLComments:[]},i&&O(l,{code:t,enter:function(e,n){if(M.includes(e.type))for(var o=0,i=h(s.normalizeJsxNode(e,n,r));o<i.length;o++){var a=i[o];s._nodeToAst(t,a,r)}}}),{ast:this._ast,services:this._services}},t.prototype._eslintParse=function(e,t){var n,r;this._parsers&&t.parser===this._options.parser||(this._parsers=u(t.parser)),t.filePath&&this._options!==t&&Object.assign(this._options,t);for(var s=0,o=this._parsers;s<o.length;s++){var i=o[s];try{n=i(e,this._options);break}catch(e){r||(r=e)}}if(!n&&r)throw r;return"ast"in n&&n.ast?n:{ast:n}},t.prototype._normalizeJsxNodes=function(e,t){var n,r=e.value;try{n=this._eslintParse("<$>"+r+"</$>",t).ast}catch(t){if(p(t,W)){var s=e.position.start;throw"index"in t?t.index+=s.offset-D:"pos"in t&&(t.pos+=s.offset-D),t.column=t.lineNumber>1?t.column:t.column+s.column-D,t.lineNumber+=s.line-1,t}return e}var o=n.body[0].expression;if(!l(o)||o.children.length<=1)return e;var i=e.position.start,a=i.line,u=i.offset,c=e.data;return o.children.reduce((function(e,t){if(!l(t))return e;var n=t.start,s=t.end,o=t.loc,i=void 0===o?{start:{column:n,line:1},end:{column:s,line:1}}:o,p=i.start,f=i.end,m=t.range,h=void 0===m?[n,s]:m,d=a+p.line-1,v=a+f.line-1,x=h[0]-D,g=h[1]-D;return e.push({type:"jsx",data:e.length>0?null:c,value:r.slice(x,g),position:{start:{line:d,column:a===d?p.column-D:p.column,offset:u+x},end:{line:v,column:a===d?f.column-D:f.column,offset:u+g}}}),e}),[])},t.prototype._nodeToAst=function(e,t,n){var r;t.data&&"JSXElementWithHTMLComments"===t.data.jsxType&&this._services.JSXElementsWithHTMLComments.push(t);var s=t.value,o=c(t.position),i=o.loc,a=o.start,l=o.end;if(P(s)){var u=T.exec(s)[2];this._ast.comments.push({type:"Block",value:u,loc:i,range:[a,l]})}else{var h,d=i.start.line-1;try{h=this._eslintParse(s,n).ast}catch(e){throw p(e,W)&&(e.index+=a,e.column=e.lineNumber>1?e.column:e.column+i.start.column,e.lineNumber+=d),e}for(var v={line:d,column:f(e,a).column,offset:a},x=0,g=H;x<g.length;x++){var y=g[x];(r=this._ast[y]).push.apply(r,h[y].map((function(e){return m(e,v)})))}}},t}(),V=new U,Y=V.parse,G=V.parseForESLint;export{H as AST_PROPS,N as CLOSE_TAG_REGEX,T as COMMENT_CONTENT_REGEX,A as COMMENT_CONTENT_REGEX_GLOBAL,z as COMMENT_REGEX,q as DEFAULT_EXTENSIONS,B as DEFAULT_PARSER_OPTIONS,M as ES_NODE_TYPES,i as FALLBACK_PARSERS,a as JSX_TYPES,W as LOC_ERROR_PROPERTIES,I as MARKDOWN_EXTENSIONS,j as OPEN_CLOSE_TAG_REGEX,J as OPEN_TAG_REGEX,U as Parser,L as SELF_CLOSING_TAG_REGEX,R as Traverse,h as arrayify,y as closeTag,b as comment,S as commentClose,w as commentContent,E as commentOpen,d as first,f as getPositionAt,p as hasProperties,k as isCloseTag,P as isComment,l as isJsxNode,Z as isOpenCloseTag,F as isOpenTag,$ as isSelfClosingTag,v as last,X as mdProcessor,C as mdxProcessor,u as normalizeParser,c as normalizePosition,g as openTag,Y as parse,G as parseForESLint,V as parser,m as restoreNodeLocation,_ as selfClosingTag,O as traverse};
